<div class="row">
    <header class="p-3 border-bottom">
        <div class="d-flex align-items-center justify-content-between w-100">
            <div class="d-flex align-items-center col">
                <a href="/" class="me-5">
                    <img src="{{ url_for('static', filename ='logo_tns.svg') }}" alt="Logo TNS" height="65" width="65">
                </a>
                <img class="me-1 h-100 rounded-circle" src="{{ url_for('static', filename='portrait_membres_tns/'+user.get('picture_filename', '')+'.jpg') }}" alt="Image du profil" width="55" height="55">
                <div class="ms-1">
                    <p class="h5 m-0">{{user.get('name', 'Connecter (utilisateur inconnu)')}}</p>
                    <a href="{{url_for('logout')}}" class="nav-underline">Se déconnecter</a>
                </div>
            </div>
            <div class="col-4 pe-5">
                <div id="search_header_dropdown" class="dropdown">
                    <input id="search_header_input" type="search" class="dropdown-toggle form-control" placeholder="Search..." aria-label="Search" data-bs-toggle="dropdown" aria-expanded="false" onfocus="filterSearchFunction()" onkeyup="filterSearchFunction()"/>
                    <ul class="dropdown-menu w-100" style="max-height: 500px; overflow-y: auto; overflow-x: clip;">
                        <span class="h4 ms-2">Projets</span>
                        {% for projet in data_for_search.0 %}
                            <li><a class="dropdown-item" href="{{url_for('projet', id=projet.id_Projet)}}">{{ projet.titre }} - {{projet.nom_client}}</a></li>
                        {% endfor %}
                        <li><hr class="dropdown-divider"></li>
                        <span class="h4 ms-2">Clients</span>
                        {% for client in data_for_search.1 %}
                            <li><a class="dropdown-item" href="{{url_for('client', id=client.id_Client)}}">{{client.nom}}</a></li>
                        {% endfor %}
                        <li><hr class="dropdown-divider"></li>
                        <span class="h4 ms-2">Intervenants</span>
                        {% for interv in data_for_search.2 %}
                            <li><a class="dropdown-item" href="{{url_for('intervenant', id=interv.id_Intervenant)}}">{{interv.nom}}</a></li>
                        {% endfor %}
                  </ul>
                </div>
<!--                <form role="search">-->
<!--                    <input type="search" class="form-control" placeholder="Search..." aria-label="Search" list="options">-->
<!--    &lt;!&ndash;                            TODO: faire la complétion automatique&ndash;&gt;-->
<!--                    <datalist id="options">-->
<!--                    </datalist>-->
<!--                </form>-->
            </div>

        </div>
    </header>
    <script>
    function filterSearchFunction() {
        const input = document.getElementById("search_header_input");
        const filter = input.value.toUpperCase();
        const div = document.getElementById("search_header_dropdown");
        const a = div.getElementsByTagName("a");
        for (let i = 0; i < a.length; i++) {
            txtValue = (a[i].textContent || a[i].innerText).toUpperCase();
            indice_filter = 0;
            for (let l = 0; l < txtValue.length; l++) {
                if (indice_filter < filter.length && txtValue[l] === filter[indice_filter]) {
                    indice_filter++;
                }
            }
            if (indice_filter === filter.length) {
                a[i].style.display = "";
            } else {
                a[i].style.display = "none";
            }
        }
    }
    </script>
</div>
